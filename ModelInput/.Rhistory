chi <- matrix(nrow = 6, ncol = 3)
colnames(chi) <- c("Commission", "Monitoring",  "Conflict")
rownames(chi) <- c("Commission", "", "Monitoring", "",  "Conflict", "")
chi[1,2] <- round(chisq.test(table(plot_dat$commission, plot_dat$monitoring))$statistic, 3)
chi[2,2] <- paste0( "(", round(chisq.test(table(plot_dat$commission, plot_dat$monitoring))$p.value, 3), ")")
chi[1,3] <- round(chisq.test(table(plot_dat$commission, plot_dat$conflict))$statistic, 3)
chi[2,3] <- paste0( "(", round(chisq.test(table(plot_dat$commission, plot_dat$conflict))$p.value, 3), ")")
chi[3,3] <- round(chisq.test(table(plot_dat$conflict, plot_dat$monitoring))$statistic, 3)
chi[4,3] <- paste0( "(", round(chisq.test(table(plot_dat$commission, plot_dat$monitoring))$p.value, 3), ")")
chi[is.na(chi)] <- "-"
latex(chi, file="")
# II. simple descriptives of co-appearance
co_app <- matrix(nrow = 4, ncol = 3)
co_app[1,1] <- table(plot_dat$pollution, plot_dat$commission)[2,2]
co_app[1,2] <- table(plot_dat$pollution, plot_dat$monitoring)[2,2]
co_app[1,3] <- table(plot_dat$pollution, plot_dat$conflict)[2,2]
co_app[2,1] <- table(plot_dat$shipping, plot_dat$commission)[2,2]
co_app[2,2] <- table(plot_dat$shipping, plot_dat$monitoring)[2,2]
co_app[2,3] <- table(plot_dat$shipping, plot_dat$conflict)[2,2]
co_app[3,1] <- table(plot_dat$fish, plot_dat$commission)[2,2]
co_app[3,2] <- table(plot_dat$fish, plot_dat$monitoring)[2,2]
co_app[3,3] <- table(plot_dat$fish, plot_dat$conflict)[2,2]
co_app[4,1] <- table(plot_dat$construction, plot_dat$commission)[2,2]
co_app[4,2] <- table(plot_dat$construction, plot_dat$monitoring)[2,2]
co_app[4,3] <- table(plot_dat$construction, plot_dat$conflict)[2,2]
colnames(co_app) <- c("Commission", "Monitoring",  "Conflict")
rownames(co_app) <- c("Pollution", "Shipping", "Fish", "Construction")
latex(co_app, file="")
## III. plot design principles and issue area over time
# create data first
p <- dyadicdat %>%
group_by(ID_SM) %>%
slice(1) %>%
as_tibble() %>%
# filter(year >= 1980) %>%
mutate(date = as.Date(time, origin = "1970-01-01"),
year = as.numeric(format(date,'%Y')),
agreement_yes = ifelse(!is.na(ID_SM), 1, 0),
Period = NA,
Period = replace(Period,  year< 1930, "<1930"),
Period = replace(Period, year>= 1930 & year< 1940, "1930-1939"),
Period = replace(Period, year>= 1940 & year< 1950, "1940-1949"),
Period = replace(Period, year>= 1950 & year< 1960, "1950-1959"),
Period = replace(Period, year>= 1960 & year< 1970, "1960-1969"),
Period = replace(Period, year>= 1970 & year< 1980, "1970-1979"),
Period = replace(Period, year>= 1980 & year< 1990, "1980-1989"),
Period = replace(Period, year>= 1990 & year< 2000, "1990-1999"),
Period = replace(Period, year>= 2000 & year< 2010, "2000-2009"),
Period = replace(Period, year>= 2010 & year<= 2020, "2010-2020"))
# Figure 1: Bilateral Agreements and Design principles over time
p %>%
reshape2::melt(., id.vars = "Period", measure.vars = c("agreement_yes", "commission", "monitoring", "conflict")) %>%
group_by(Period, variable) %>%
summarise(Frequency = sum(value)) %>%
ggplot() +
geom_bar(  mapping = aes(x=Period, y=Frequency, fill = Period), width=.3,
stat="identity", position = "dodge") +
facet_wrap(~variable, ncol=4, scale = "free",
labeller = labeller(variable = c("agreement_yes" = "Agreement (yes)",
"commission" = "Commission (yes)",
"monitoring" = "Monitoring (yes)",
"conflict" = "Conflict (yes)"))) +
theme_classic() +
# coord_flip() +
theme(
text = element_text(size=12),
axis.text=element_text(size=12, angle = 90),
axis.ticks.length.x = unit(.2, "cm"),
axis.ticks.x = element_blank(),
axis.text.x = element_text(angle = 90, vjust=0.5, hjust=1),
panel.grid.major.y = element_line(colour = "grey40"),
panel.grid.major.x = element_blank(),
panel.spacing = unit(3, "lines"),
strip.background = element_rect(color = "white"),
strip.text.x = element_text(size = 15),
strip.placement = "inside",
legend.position = "none"
) +
ylab("New Agreements") +   xlab("") +
scale_fill_manual(values =  c(rep("grey", 6), rep("black", 4))) +
scale_alpha_manual( guide = guide_legend(override.aes = list(linetype = c(0, 1),
shape = c(16, NA),
color = "black") ) ) +
scale_y_continuous(limits=c(0,20), expand = c(0, 0))
dev.off()
# Figure Appendix: Bilateral Agreements and Issue Area over Time
p %>%
reshape2::melt(., id.vars = "Period", measure.vars = c("pollution", "shipping", "fish", "construction")) %>%
group_by(Period, variable) %>%
summarise(Frequency = sum(value)) %>%
ggplot() +
geom_bar(  mapping = aes(x=Period, y=Frequency, fill = Period) ,width=.3,
stat="identity", position = "dodge") +
facet_wrap(~variable, ncol=4, scale = "free",
labeller = labeller(variable = c("pollution" = "Pollution",
"shipping" = "Shipping",
"fish" = "Fish",
"construction" = "Construction"))) +
theme_classic() +
# coord_flip() +
theme(
text = element_text(size=12),
axis.ticks.length.x = unit(.2, "cm"),
axis.ticks.x = element_blank(),
axis.text.x = element_text(angle = 90, vjust=0.5, hjust=1),
panel.grid.major.y = element_line(colour = "grey40"),
panel.grid.major.x = element_blank(),
panel.spacing = unit(3, "lines"),
strip.background = element_rect(color = "white"),
strip.text.x = element_text(size = 15),
strip.placement = "inside",
legend.position = "none"
) +
ylab("New Agreements") +   xlab("") +
scale_fill_manual(values =  c(rep("grey", 6), rep("black", 4))) +
scale_alpha_manual( guide = guide_legend(override.aes = list(linetype = c(0, 1),
shape = c(16, NA),
color = "black") ) ) +
scale_y_continuous(limits=c(0,20), expand = c(0, 0))
dev.off()
## IV. standard summary table
library(summarytools)
sum_dat <- dyadicdat[dyadicdat$year >= 1980,] %>%  ungroup() %>%
dplyr::select(treaty_yes, commission, monitoring, conflict, agr_cum, commission_cum, monitoring_cum, conflict_cum, pollution, shipping, fish, construction,
bi_lingue, symmetry)
sum_tab <- summarytools::descr(sum_dat, transpose = T, stats = c("n.valid", "mean", "sd", "min", "q1", "med", "q3", "max"), order = "preserve")
sum_tab <- round(sum_tab, 2)
rownames(sum_tab) <- c("Agreement (yes)",
"Commission (yes)",
"Monitoring (yes)",
"Conflict Resolution (yes)",
"Prior Agreements",
"Prior Commission",
"Prior Monitoring",
"Prior Conflict Resolution",
"Pollution (yes)",
"Shipping (yes)",
"Fish (yes)",
"Construction (yes)",
"Bi-lingue (yes)",
"Symmetry")
latex(sum_tab, file="")
# are the data set up correctly? Triple check
dyadicdat %>%
arrange(cantons, time) %>%
dplyr::select(ID_SM, cantons, time, year, date, commission, monitoring, conflict, commission_cum, monitoring_cum, conflict_cum, agr_cum, treaty_yes) %>%
as.data.frame()
############
# (5) analysis of repeated events
############
# Weibull distribution because the event rate is increasing over time
weib_1 <- survreg(Surv(time, treaty_yes) ~ agr_cum + commission_cum + monitoring_cum + conflict_cum
+ cluster(dyad_id), data = dyadicdat[dyadicdat$year >= 1980 | dyadicdat$year == 0,], dist = "weibull")
weib_2 <- survreg(Surv(time, treaty_yes) ~ agr_cum + commission_cum + monitoring_cum + conflict_cum
+ pollution	+ shipping +	fish + construction + symmetry + bi_lingue + cluster(dyad_id), data = dyadicdat[dyadicdat$year >= 1980 | dyadicdat$year == 0,], dist = "weibull")
weib_3 <- survreg(Surv(time, any_mech_yes) ~ agr_cum + commission_cum + monitoring_cum + conflict_cum
+ cluster(dyad_id), data = dyadicdat[dyadicdat$year >= 1980 | dyadicdat$year == 0,], dist = "weibull")
weib_4 <- survreg(Surv(time, any_mech_yes) ~ agr_cum + commission_cum + monitoring_cum + conflict_cum
+ pollution	+ shipping +	fish + construction + symmetry + bi_lingue + cluster(dyad_id), data = dyadicdat[dyadicdat$year >= 1980 | dyadicdat$year == 0,], dist = "weibull")
weib_5 <- survreg(Surv(time, commission) ~ agr_cum + commission_cum + monitoring_cum + conflict_cum
+ cluster(dyad_id), data = dyadicdat[dyadicdat$year >= 1980 | dyadicdat$year == 0,], dist = "weibull")
weib_6 <- survreg(Surv(time, commission) ~ agr_cum + commission_cum + monitoring_cum + conflict_cum
+ pollution	+ shipping +	fish + construction + symmetry + bi_lingue + cluster(dyad_id), data = dyadicdat[dyadicdat$year >= 1980 | dyadicdat$year == 0,], dist = "weibull")
weib_7 <- survreg(Surv(time, monitoring) ~ agr_cum + commission_cum + monitoring_cum + conflict_cum
+ cluster(dyad_id), data = dyadicdat[dyadicdat$year >= 1980 | dyadicdat$year == 0,], dist = "weibull")
weib_8 <- survreg(Surv(time, monitoring) ~ agr_cum + commission_cum + monitoring_cum + conflict_cum
+ pollution	+ shipping +	fish + construction + symmetry + bi_lingue + cluster(dyad_id), data = dyadicdat[dyadicdat$year >= 1980 | dyadicdat$year == 0,], dist = "weibull")
weib_9 <- survreg(Surv(time, conflict) ~ agr_cum + commission_cum + monitoring_cum + conflict_cum
+ cluster(dyad_id), data = dyadicdat[dyadicdat$year >= 1980 | dyadicdat$year == 0,], dist = "weibull")
weib_10 <- survreg(Surv(time, conflict) ~ agr_cum + commission_cum + monitoring_cum + conflict_cum
+ pollution	+ shipping  + construction + symmetry + bi_lingue + cluster(dyad_id), data = dyadicdat[dyadicdat$year >= 1980 | dyadicdat$year == 0,], dist = "weibull")
texreg::texreg(list(weib_1, weib_2, weib_3, weib_4, weib_5, weib_6, weib_7, weib_8, weib_9, weib_10),
custom.header = list("Agreement (yes)" = 1:2, "Any Mechanism (yes)" = 3:4, "Commission (yes)" = 5:6, "Monitoring (yes)" = 7:8, "Conflict (yes)" = 9:10),
booktabs = T,
sideways = T,
custom.coef.names = c("Intercept",
"Prior Agreements",
"Prior Commission",
"Prior Monitoring",
"Prior Conflict Resolution",
"Log (scale)",
"Pollution",
"Shipping",
"Fish",
"Construction",
"Symmetry",
"Bi-lingue"),
caption = "Survival Model for Bilateral Water Agreements after 1980 based on a Weibull Distribution",
)
### Swiss Water Coooperation
## Authors: Simon Montfort, Manuel Fischer, James Hollway, Nicolas Jager
# R.version
# platform       x86_64-apple-darwin17.0
# arch           x86_64
# os             darwin17.0
# system         x86_64, darwin17.0
# status
# major          4
# minor          0.4
# year           2021
# month          02
# day            15
# svn rev        80002
# language       R
# version.string R version 4.0.4 (2021-02-15)
# nickname       Lost Library Book
######################################
### Load packages
######################################
rm(list = ls())
library("dplyr")
library("ggplot2")
library("summarytools")
library("survival")
library("survminer")
library("igraph")
library("ggrepel")
library("Hmisc")
######################################
# description of code
######################################
# The code proceeds in steps:
# (1) loading treaty data and subsetting to bilaterals
# (2) definition of risk set to contiguity over land
# (3) variables and covariates
# (4) descriptives
# (5) analysis
# (6) robustness checks
######################################
# (1) treaty design data
######################################
# change directory here to replicate
setwd("/Users/simon/Documents/repo/swiss-water-agreement-design/ModelInput")
load("dyadicdat.RData")
# create DV for agreements
dyadicdat <- dyadicdat %>%
mutate(treaty_yes = ifelse(!is.na(ID_SM), 1, 0))
dyadicdat <- dyadicdat %>%
mutate(year = as.numeric(format(as.Date(time, origin = "1970-01-01"),'%Y')),
date = as.numeric(format(as.Date(time, origin = "1970-01-01"),'%Y%m%d')))
# # subset to bilateral agreements
# dyadicdat <- dyadicdat %>% filter(bilateral == 1)
# # subset to those issues included
dyadicdat <- dyadicdat %>%
filter(pollution == 1 | fish == 1 | shipping == 1 | construction == 1 )
# dyadic data: also make sure that it is orderered by name
dyadicdat <- dyadicdat %>%
mutate(canton1 = as.character(canton1),
canton2 = as.character(canton2),
cantons = ifelse(canton1 < canton2, paste(canton1, canton2), paste(canton2, canton1)))
##########
# (2) risk set
##########
# risk set rivers
load("risk_set.RData")
# join datasets
dyadicdat <- left_join(dyads, dyadicdat %>% dplyr::select(-canton1, -canton2), by = c("cantons" = "cantons"))
# for those cantons which did not experience an event at the end of the study time, i.e. empty risk sets should have the end of the study period in the relevant time variable
dyadicdat$time[is.na(dyadicdat$time)] <- as.numeric(as.Date("2020-01-01")) # in numeric format, 18262 is the end of the study period, this is lower than
# bilateral agreements are only contiguous, this is just to double check that they. should be empty
dyadicdat$cantons[!dyadicdat$cantons %in% dyads$cantons] # perfect, it is empty
# replace NAs with zero because these are the observations that did not experience the event. For all those observations, the data is NA although the mechanisms (DVs) should be zero as
# to event did not occur
dyadicdat[is.na(dyadicdat)] <- 0
############
# (3) variables
############
# I. sequencing
dyadicdat <- dyadicdat %>%
group_by(cantons) %>%
arrange(cantons, time) %>%
mutate(agr_cum = row_number() -1,
conflict_cum = cumsum(conflict) -1,
monitoring_cum = cumsum(monitoring) -1,
commission_cum = cumsum(commission) -1) %>%
mutate(agr_cum = ifelse(agr_cum == -1, agr_cum +1, agr_cum),
conflict_cum = ifelse(conflict_cum == -1, conflict_cum +1, conflict_cum),
monitoring_cum = ifelse( monitoring_cum == -1, monitoring_cum +1, monitoring_cum),
commission_cum = ifelse(commission_cum == -1, commission_cum +1, commission_cum))
# inspect data setup, check sequencing variables
dyadicdat %>%
arrange(cantons, time) %>%
dplyr::select(cantons, time, treaty_yes, conflict, monitoring, commission, agr_cum, conflict_cum, monitoring_cum, commission_cum) %>%
as.data.frame()
# II. external mechanisms
dyadicdat <- dyadicdat %>%
mutate(any_ext_yes = ifelse(mon_comm == 1 | conf_body == 1 | conf_fed == 1 | commission == 1, 1, 0),
any_mech_yes = ifelse(commission == 1 | monitoring == 1 | conflict == 1, 1, 0))
## look at structure of the data to check that cummulative sums have been calculated correctly
dyadicdat %>% group_by(cantons) %>%  arrange(cantons, time) %>% mutate(id = cur_group_id()) %>%
dplyr::select(id, cantons, time, enforcement, monitoring, conflict, commission_cum, monitoring_cum, conflict_cum, agr_cum) %>% as.data.frame()
# add dyad id to cluster s.e. later for modelling
dyadicdat <- dyadicdat %>% group_by(cantons) %>%  arrange(cantons, time) %>% mutate(dyad_id = cur_group_id())
## III. upstream/downstream operationalisation
load("US_DS_matrix_polygons_within_2.RData")
for (i in 1:nrow(dyadicdat)){
dyadicdat$drain_1_to_2[i] <- mat[dyadicdat$canton1[i] == rownames(mat), dyadicdat$canton2[i] == colnames(mat)]
dyadicdat$drain_2_to_1[i] <- mat[dyadicdat$canton2[i] == rownames(mat), dyadicdat$canton1[i] == colnames(mat)]
}
# ## Water Salience, Symmetry and Interdependence based on trade interdependence by Crescenzi but adapted to fit water interdependence, p.30
dyadicdat$total_wat <- (dyadicdat$drain_1_to_2 + dyadicdat$drain_2_to_1)
dyadicdat$share_drain_1 <- dyadicdat$drain_1_to_2/dyadicdat$total_wat
dyadicdat$share_drain_2 <- dyadicdat$drain_2_to_1/dyadicdat$total_wat
dyadicdat$symmetry <- 1 - abs(dyadicdat$share_drain_1 - dyadicdat$share_drain_2)
# adapt risk set becuse cantons cannot cooperate when no water flows from one to the other
dyadicdat <- dyadicdat[!is.nan(dyadicdat$symmetry),]
# IV. language
load("bi_lingue.RData")
dyadicdat <- left_join(dyadicdat, bi_lingue, by = c("cantons" = "cantons", "ID_SM" = "ID_SM"))
#################
# (4) descriptives
#################
# for descriptives, subset to those dyads that experienced an agreement after 1980 or did not experience an agreement at all
plot_dat <- dyadicdat[dyadicdat$year >= 1980 &
dyadicdat$year != 0,]
# I. correlation between mechanisms
chi <- matrix(nrow = 6, ncol = 3)
colnames(chi) <- c("Commission", "Monitoring",  "Conflict")
rownames(chi) <- c("Commission", "", "Monitoring", "",  "Conflict", "")
chi[1,2] <- round(chisq.test(table(plot_dat$commission, plot_dat$monitoring))$statistic, 3)
chi[2,2] <- paste0( "(", round(chisq.test(table(plot_dat$commission, plot_dat$monitoring))$p.value, 3), ")")
chi[1,3] <- round(chisq.test(table(plot_dat$commission, plot_dat$conflict))$statistic, 3)
chi[2,3] <- paste0( "(", round(chisq.test(table(plot_dat$commission, plot_dat$conflict))$p.value, 3), ")")
chi[3,3] <- round(chisq.test(table(plot_dat$conflict, plot_dat$monitoring))$statistic, 3)
chi[4,3] <- paste0( "(", round(chisq.test(table(plot_dat$commission, plot_dat$monitoring))$p.value, 3), ")")
chi[is.na(chi)] <- "-"
latex(chi, file="")
# II. simple descriptives of co-appearance
co_app <- matrix(nrow = 4, ncol = 3)
co_app[1,1] <- table(plot_dat$pollution, plot_dat$commission)[2,2]
co_app[1,2] <- table(plot_dat$pollution, plot_dat$monitoring)[2,2]
co_app[1,3] <- table(plot_dat$pollution, plot_dat$conflict)[2,2]
co_app[2,1] <- table(plot_dat$shipping, plot_dat$commission)[2,2]
co_app[2,2] <- table(plot_dat$shipping, plot_dat$monitoring)[2,2]
co_app[2,3] <- table(plot_dat$shipping, plot_dat$conflict)[2,2]
co_app[3,1] <- table(plot_dat$fish, plot_dat$commission)[2,2]
co_app[3,2] <- table(plot_dat$fish, plot_dat$monitoring)[2,2]
co_app[3,3] <- table(plot_dat$fish, plot_dat$conflict)[2,2]
co_app[4,1] <- table(plot_dat$construction, plot_dat$commission)[2,2]
co_app[4,2] <- table(plot_dat$construction, plot_dat$monitoring)[2,2]
co_app[4,3] <- table(plot_dat$construction, plot_dat$conflict)[2,2]
colnames(co_app) <- c("Commission", "Monitoring",  "Conflict")
rownames(co_app) <- c("Pollution", "Shipping", "Fish", "Construction")
latex(co_app, file="")
## III. plot design principles and issue area over time
# create data first
p <- dyadicdat %>%
group_by(ID_SM) %>%
slice(1) %>%
as_tibble() %>%
# filter(year >= 1980) %>%
mutate(date = as.Date(time, origin = "1970-01-01"),
year = as.numeric(format(date,'%Y')),
agreement_yes = ifelse(!is.na(ID_SM), 1, 0),
Period = NA,
Period = replace(Period,  year< 1930, "<1930"),
Period = replace(Period, year>= 1930 & year< 1940, "1930-1939"),
Period = replace(Period, year>= 1940 & year< 1950, "1940-1949"),
Period = replace(Period, year>= 1950 & year< 1960, "1950-1959"),
Period = replace(Period, year>= 1960 & year< 1970, "1960-1969"),
Period = replace(Period, year>= 1970 & year< 1980, "1970-1979"),
Period = replace(Period, year>= 1980 & year< 1990, "1980-1989"),
Period = replace(Period, year>= 1990 & year< 2000, "1990-1999"),
Period = replace(Period, year>= 2000 & year< 2010, "2000-2009"),
Period = replace(Period, year>= 2010 & year<= 2020, "2010-2020"))
# Figure 1: Bilateral Agreements and Design principles over time
p %>%
reshape2::melt(., id.vars = "Period", measure.vars = c("agreement_yes", "commission", "monitoring", "conflict")) %>%
group_by(Period, variable) %>%
summarise(Frequency = sum(value)) %>%
ggplot() +
geom_bar(  mapping = aes(x=Period, y=Frequency, fill = Period), width=.3,
stat="identity", position = "dodge") +
facet_wrap(~variable, ncol=4, scale = "free",
labeller = labeller(variable = c("agreement_yes" = "Agreement (yes)",
"commission" = "Commission (yes)",
"monitoring" = "Monitoring (yes)",
"conflict" = "Conflict (yes)"))) +
theme_classic() +
# coord_flip() +
theme(
text = element_text(size=12),
axis.text=element_text(size=12, angle = 90),
axis.ticks.length.x = unit(.2, "cm"),
axis.ticks.x = element_blank(),
axis.text.x = element_text(angle = 90, vjust=0.5, hjust=1),
panel.grid.major.y = element_line(colour = "grey40"),
panel.grid.major.x = element_blank(),
panel.spacing = unit(3, "lines"),
strip.background = element_rect(color = "white"),
strip.text.x = element_text(size = 15),
strip.placement = "inside",
legend.position = "none"
) +
ylab("New Agreements") +   xlab("") +
scale_fill_manual(values =  c(rep("grey", 6), rep("black", 4))) +
scale_alpha_manual( guide = guide_legend(override.aes = list(linetype = c(0, 1),
shape = c(16, NA),
color = "black") ) ) +
scale_y_continuous(limits=c(0,20), expand = c(0, 0))
dev.off()
# Figure Appendix: Bilateral Agreements and Issue Area over Time
p %>%
reshape2::melt(., id.vars = "Period", measure.vars = c("pollution", "shipping", "fish", "construction")) %>%
group_by(Period, variable) %>%
summarise(Frequency = sum(value)) %>%
ggplot() +
geom_bar(  mapping = aes(x=Period, y=Frequency, fill = Period) ,width=.3,
stat="identity", position = "dodge") +
facet_wrap(~variable, ncol=4, scale = "free",
labeller = labeller(variable = c("pollution" = "Pollution",
"shipping" = "Shipping",
"fish" = "Fish",
"construction" = "Construction"))) +
theme_classic() +
# coord_flip() +
theme(
text = element_text(size=12),
axis.ticks.length.x = unit(.2, "cm"),
axis.ticks.x = element_blank(),
axis.text.x = element_text(angle = 90, vjust=0.5, hjust=1),
panel.grid.major.y = element_line(colour = "grey40"),
panel.grid.major.x = element_blank(),
panel.spacing = unit(3, "lines"),
strip.background = element_rect(color = "white"),
strip.text.x = element_text(size = 15),
strip.placement = "inside",
legend.position = "none"
) +
ylab("New Agreements") +   xlab("") +
scale_fill_manual(values =  c(rep("grey", 6), rep("black", 4))) +
scale_alpha_manual( guide = guide_legend(override.aes = list(linetype = c(0, 1),
shape = c(16, NA),
color = "black") ) ) +
scale_y_continuous(limits=c(0,20), expand = c(0, 0))
dev.off()
## IV. standard summary table
library(summarytools)
sum_dat <- dyadicdat[dyadicdat$year >= 1980,] %>%  ungroup() %>%
dplyr::select(treaty_yes, commission, monitoring, conflict, agr_cum, commission_cum, monitoring_cum, conflict_cum, pollution, shipping, fish, construction,
bi_lingue, symmetry)
sum_tab <- summarytools::descr(sum_dat, transpose = T, stats = c("n.valid", "mean", "sd", "min", "q1", "med", "q3", "max"), order = "preserve")
sum_tab <- round(sum_tab, 2)
rownames(sum_tab) <- c("Agreement (yes)",
"Commission (yes)",
"Monitoring (yes)",
"Conflict Resolution (yes)",
"Prior Agreements",
"Prior Commission",
"Prior Monitoring",
"Prior Conflict Resolution",
"Pollution (yes)",
"Shipping (yes)",
"Fish (yes)",
"Construction (yes)",
"Bi-lingue (yes)",
"Symmetry")
latex(sum_tab, file="")
# are the data set up correctly? Triple check
dyadicdat %>%
arrange(cantons, time) %>%
dplyr::select(ID_SM, cantons, time, year, date, commission, monitoring, conflict, commission_cum, monitoring_cum, conflict_cum, agr_cum, treaty_yes) %>%
as.data.frame()
############
# (5) analysis of repeated events
############
# Weibull distribution because the event rate is increasing over time
weib_1 <- survreg(Surv(time, treaty_yes) ~ agr_cum + commission_cum + monitoring_cum + conflict_cum
+ cluster(dyad_id), data = dyadicdat[dyadicdat$year >= 1980 | dyadicdat$year == 0,], dist = "weibull")
weib_2 <- survreg(Surv(time, treaty_yes) ~ agr_cum + commission_cum + monitoring_cum + conflict_cum
+ pollution	+ shipping +	fish + construction + symmetry + bi_lingue + cluster(dyad_id), data = dyadicdat[dyadicdat$year >= 1980 | dyadicdat$year == 0,], dist = "weibull")
weib_3 <- survreg(Surv(time, any_mech_yes) ~ agr_cum + commission_cum + monitoring_cum + conflict_cum
+ cluster(dyad_id), data = dyadicdat[dyadicdat$year >= 1980 | dyadicdat$year == 0,], dist = "weibull")
weib_4 <- survreg(Surv(time, any_mech_yes) ~ agr_cum + commission_cum + monitoring_cum + conflict_cum
+ pollution	+ shipping +	fish + construction + symmetry + bi_lingue + cluster(dyad_id), data = dyadicdat[dyadicdat$year >= 1980 | dyadicdat$year == 0,], dist = "weibull")
weib_5 <- survreg(Surv(time, commission) ~ agr_cum + commission_cum + monitoring_cum + conflict_cum
+ cluster(dyad_id), data = dyadicdat[dyadicdat$year >= 1980 | dyadicdat$year == 0,], dist = "weibull")
weib_6 <- survreg(Surv(time, commission) ~ agr_cum + commission_cum + monitoring_cum + conflict_cum
+ pollution	+ shipping +	fish + construction + symmetry + bi_lingue + cluster(dyad_id), data = dyadicdat[dyadicdat$year >= 1980 | dyadicdat$year == 0,], dist = "weibull")
weib_7 <- survreg(Surv(time, monitoring) ~ agr_cum + commission_cum + monitoring_cum + conflict_cum
+ cluster(dyad_id), data = dyadicdat[dyadicdat$year >= 1980 | dyadicdat$year == 0,], dist = "weibull")
weib_8 <- survreg(Surv(time, monitoring) ~ agr_cum + commission_cum + monitoring_cum + conflict_cum
+ pollution	+ shipping +	fish + construction + symmetry + bi_lingue + cluster(dyad_id), data = dyadicdat[dyadicdat$year >= 1980 | dyadicdat$year == 0,], dist = "weibull")
weib_9 <- survreg(Surv(time, conflict) ~ agr_cum + commission_cum + monitoring_cum + conflict_cum
+ cluster(dyad_id), data = dyadicdat[dyadicdat$year >= 1980 | dyadicdat$year == 0,], dist = "weibull")
weib_10 <- survreg(Surv(time, conflict) ~ agr_cum + commission_cum + monitoring_cum + conflict_cum
+ pollution	+ shipping  + construction + symmetry + bi_lingue + cluster(dyad_id), data = dyadicdat[dyadicdat$year >= 1980 | dyadicdat$year == 0,], dist = "weibull")
texreg::texreg(list(weib_1, weib_2, weib_3, weib_4, weib_5, weib_6, weib_7, weib_8, weib_9, weib_10),
custom.header = list("Agreement (yes)" = 1:2, "Any Mechanism (yes)" = 3:4, "Commission (yes)" = 5:6, "Monitoring (yes)" = 7:8, "Conflict (yes)" = 9:10),
booktabs = T,
sideways = T,
custom.coef.names = c("Intercept",
"Prior Agreements",
"Prior Commission",
"Prior Monitoring",
"Prior Conflict Resolution",
"Log (scale)",
"Pollution",
"Shipping",
"Fish",
"Construction",
"Symmetry",
"Bi-lingue"),
caption = "Survival Model for Bilateral Water Agreements after 1980 based on a Weibull Distribution",
)
# are the data set up correctly? Triple check
dyadicdat %>%
arrange(cantons, time) %>%
dplyr::select(ID_SM, cantons, time, year, date, commission, monitoring, conflict, commission_cum, monitoring_cum, conflict_cum, agr_cum, treaty_yes) %>%
as.data.frame()
library(rdna)
library(rdna)
